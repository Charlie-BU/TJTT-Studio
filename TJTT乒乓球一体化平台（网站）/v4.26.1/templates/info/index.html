{% extends "info/info_base.html" %}
{% block title %}TJTT乒乓球积分赛平台{% endblock %}

{% block head %}{% endblock %}

{% block body %}
    {#flash弹窗#}
    {% for message in get_flashed_messages() %}
        <div class="alert alert-warning">{{ message }}&nbsp;&nbsp;
{#            <button class="btn waves-effect waves-light btn-rounded btn-outline-primary"#}
{#                    id="refresh"#}
{#                    onclick="location.reload()">{{_("刷新")}}#}
{#            </button>#}
        </div>
    {% endfor %}

    {% if user.password == "123" or user.password == "12345" or not user.phone or not user.email or not user.stu_num or not user.hand or not user.grip or not user.blade or not user.forehand or not user.backhand or not user.particle or not user.address %}
        <!--飘窗-->
        <div id="roll" style="position: fixed; z-index: 999;">
            {% if user.password == "123" or user.password == "12345" %}
                <div class="card">
                    <div class="card-body">
                        <h3 class="card-title" style="color: red;">{{_("您尚未修改个人密码，账号存在极大安<br/>全风险，请尽快在“个人信息”中修改！")}}</h3>
                        <a class="btn waves-effect waves-light btn-rounded btn-outline-primary"
                           href="{{ url_for('user.my_profile') }}">{{_("修改个人密码")}}
                        </a>
                    </div>
                </div>
            {% endif %}
            {% if not user.phone or not user.email or not user.stu_num or not user.hand or not user.grip or not user.blade or not user.forehand or not user.backhand or not user.particle or not user.address %}
                <div class="card">
                    <div class="card-body">
                        <h3 class="card-title" style="color: red;">{{_("您尚未完善个人信息，请尽快在“个人信<br/>息”中完善，否则将影响后续平台使用！")}}</h3>
                        <a class="btn waves-effect waves-light btn-rounded btn-outline-primary"
                           href="{{ url_for('user.my_profile') }}">{{_("完善个人信息")}}
                        </a>
                    </div>
                </div>
            {% endif %}
        </div>
    {% endif %}

    <div class="page-breadcrumb">
        <div class="row">
            <div class="col-7 align-self-center" style="font-weight: bold;">
                <h3 class="page-title text-truncate text-dark font-weight-bold mb-1">{{_("欢迎")}} {{ user.username }}！</h3>
                <div class="d-flex align-items-center">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb m-0 p-0">
                            <li class="breadcrumb-item"><p>{{ _("Welcome") }}！</p>
                            </li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </div>


    <div class="container-fluid">
        <div class="card-group">
            <div class="card border-right">
                <div class="card-body">
                    <div class="d-flex d-lg-flex d-md-block align-items-center">
                        <div>
                            <h2 class="text-dark mb-1 font-weight-medium">{{ users|length }}</h2>
                            <h6 class="text-muted font-weight-normal mb-0 w-100 text-truncate">{{_("现有用户")}}</h6>
                        </div>
                        <div class="ml-auto mt-md-3 mt-lg-0">
                            <span class="opacity-7 text-muted"><i data-feather="user"></i></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card border-right">
                <div class="card-body">
                    <div class="d-flex d-lg-flex d-md-block align-items-center">
                        <div>
                            <h2 class="text-dark mb-1 font-weight-medium">{{ organs|length }}</h2>
                            <h6 class="text-muted font-weight-normal mb-0 w-100 text-truncate">{{_("全国组织")}}</h6>
                        </div>
                        <div class="ml-auto mt-md-3 mt-lg-0">
                            <span class="opacity-7 text-muted"><i data-feather="users"></i></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card border-right">
                <div class="card-body">
                    <div class="d-flex d-lg-flex d-md-block align-items-center">
                        <div>
                            <div class="d-inline-flex align-items-center">
                                <h2 class="text-dark mb-1 w-100 font-weight-medium">{{ c_matches|length }}</h2>
                                <span class="badge bg-primary font-12 text-white font-weight-medium badge-pill ml-2 d-lg-block d-md-none">+2</span>
                            </div>
                            <h6 class="text-muted font-weight-normal mb-0 w-100 text-truncate">{{_("近期赛事")}}
                            </h6>
                        </div>
                        <div class="ml-auto mt-md-3 mt-lg-0">
                            <span class="opacity-7 text-muted"><i data-feather="list"></i></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card border-right">
                <div class="card-body">
                    <div class="d-flex d-lg-flex d-md-block align-items-center">
                        <div>
                            <div class="d-inline-flex align-items-center">
                                <h2 class="text-dark mb-1 font-weight-medium">{{ K9|length }}</h2>
{#                                <span class="badge bg-danger font-12 text-white font-weight-medium badge-pill ml-2 d-md-none d-lg-block">-18.33%</span>#}
                            </div>
                            <h6 class="text-muted font-weight-normal mb-0 w-100 text-truncate">临时管理员 / 外校管理员</h6>
                        </div>
                        <div class="ml-auto mt-md-3 mt-lg-0">
                            <span class="opacity-7 text-muted"><i data-feather="user-plus"></i></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card border-right">
                <div class="card-body">
                    <div class="d-flex d-lg-flex d-md-block align-items-center">
                        <div>
                            <h2 class="text-dark mb-1 font-weight-medium">16</h2>
                            <h6 class="text-muted font-weight-normal mb-0 w-100 text-truncate">{{ _("TJTT项目组成员")}}</h6>
                        </div>
                        <div class="ml-auto mt-md-3 mt-lg-0">
                            <span class="opacity-7 text-muted"><i data-feather="user-check"></i></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <div class="row">
            <div class="col-lg-4 col-md-12">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">第一赛季 S01</h4>
                        <img class="img-fluid rounded-circle" alt="" src="{{ url_for('static', filename='images/badge-S1.jpg') }}">
                        <ul class="list-style-none mb-0">
                            <div class="mt-3">
                                <i class="fas fa-circle text-primary font-10 mr-2"></i>
                                <span class="text-dark">起始日</span>
                                <span class="text-dark float-right font-weight-medium">2024-3-11</span>
                            </div>
                            <div class="mt-3">
                                <i class="fas fa-circle text-danger font-10 mr-2"></i>
                                <span class="text-dark">终止日</span>
                                <span class="text-dark float-right font-weight-medium">2024-6-11</span>
                            </div>
                            <div class="mt-3">
                                <i class="fas fa-circle text-cyan font-10 mr-2"></i>
                                <span class="text-dark">赛事数</span>
                                <span class="text-dark float-right font-weight-medium">6</span>
                            </div>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="col-lg-4 col-md-12">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title nowrap">通知公告</h4>
                        <div class="mt-4 activity">
                            {% if notices|length >= 2 %}
                                <div class="d-flex align-items-start border-left-line pb-3">
                                    <div>
                                        <a href="javascript:void(0)" class="btn btn-danger btn-circle mb-2 btn-item">
                                            <i data-feather="bell"></i>
                                        </a>
                                    </div>
                                    <div class="ml-3 mt-2">
                                        <h5 class="text-dark font-weight-medium mb-2">{{  notices[0].title }}</h5>
                                        <p class="font-14 mb-2 text-muted">{{  notices[0].content }}</p>
                                        <span class="font-weight-light font-14 text-muted">{{  notices[0].time }}</span>
                                    </div>
                                </div>
                                <div class="d-flex align-items-start border-left-line pb-3">
                                    <div>
                                        <a href="javascript:void(0)" class="btn btn-primary btn-circle mb-2 btn-item">
                                            <i data-feather="bell"></i>
                                        </a>
                                    </div>
                                    <div class="ml-3 mt-2">
                                        <h5 class="text-dark font-weight-medium mb-2">{{  notices[1].title }}</h5>
                                        <p class="font-14 mb-2 text-muted">{{  notices[1].content }}</p>
                                        <span class="font-weight-light font-14 mb-1 d-block text-muted">{{  notices[1].time }}</span>
                                        <a data-toggle="modal" data-target="#notices" class="font-14 border-bottom pb-1 border-info" style="cursor: pointer;">更多</a>
                                        {% if user.usertype == "K9" or user.usertype == "K10" or user.usertype == "K11" %}
                                            <div style="text-align: end;">
                                                <button class="btn waves-effect waves-light btn-rounded btn-outline-primary"
                                                        data-bs-toggle="modal"
                                                        data-bs-target="#issueNotice">发布通知公告
                                                </button>
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            {#模态弹框1#}
            <div class="modal fade" id="issueNotice" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
                 aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">{{_("发布通知公告")}}</h5>
                        </div>

                        <form method="POST" action="{{ url_for("user.issue_notice") }}">
                            <div class="modal-body">
                                <div class="col-sm-12 col-md-12 col-lg-12">
                                    <div class="card">
                                        <div class="card-body">
                                            <input type="number" class="form-control" id="my_id" name="my_id" value="{{ user.id }}" style="display: none;">
                                            <label for="title" class="text-dark">{{_("标题")}}：</label>
                                            <input class="form-control" name="title" id="title">
                                            <label for="content" class="text-dark">{{_("内容")}}：</label>
                                            <textarea class="form-control" rows="5" id="content" name="content"></textarea><br/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="submit" class="btn btn-rounded btn-outline-primary">{{_("发布")}}</button>
                                <button type="button" class="btn btn-rounded btn-outline-secondary" data-bs-dismiss="modal">{{_("取消")}}</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            {#模态弹框2#}
            <div class="modal fade" id="notices" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
                 aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="col-sm-12 col-lg-12 col-md-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="card-title text-center nowrap">通知公告</h4>
                                    <div class="mt-4 activity">
                                        <table id="pageListTable">
                                            <tbody id="pageListTableBody">
                                            {% for notice in notices %}
                                                <tr>
                                                    <td>
                                                        <div class="d-flex align-items-start border-left-line pb-3">
                                                            <div>
                                                                <div class="btn-group">
                                                                    <button href="javascript:void(0)" class="btn btn-cyan btn-circle mb-2 btn-item dropdown-toggle"
                                                                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                                        <i data-feather="bell"></i>
                                                                    </button>
                                                                    {% if user.usertype == "K9" or user.usertype == "K10" or user.usertype == "K11" %}
                                                                        <div class="dropdown-menu dropdown-menu-left">
                                                                            <button class="dropdown-item text-center"
                                                                                    id="delete_notice_{{ notice.id }}"
                                                                                    onclick="delete_notice('{{ notice.id }}')"
                                                                                    type="button"
                                                                                    style="color: red;">{{_("删除")}}
                                                                            </button>
                                                                        </div>
                                                                    {% endif %}
                                                                </div>
                                                            </div>
                                                            <div class="ml-3 mt-2">
                                                                <h5 class="text-dark font-weight-medium mb-2">{{ notice.title }}</h5>
                                                                <p class="font-14 mb-2 text-muted">{{ notice.content }}</p>
                                                                <span class="font-weight-light font-14 text-muted">{{ notice.time }}</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                    <ul id="pages" class="pagination float-right nowrap">
                                        <li class="page-item"><button id="spanFirst" class="page-link" tabindex="-1">首页</button></li>
                                        <li class="page-item"><button id="spanPre" class="page-link">上一页</button></li>
                                        <li class="page-item"><button id="spanNext" class="page-link">下一页</button></li>
                                        <li class="page-item"><button id="spanLast" class="page-link">末页</button></li>
                                        <li class="page-item"><a id="spanNext" class="page-link">第<strong id="spanPageNum"></strong>页/共<strong id="spanTotalPage"></strong>页</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4 col-md-12">
                <div class="card">
                    <div class="card-body text-dark">
                        <h4 class="card-title">TJTT Logo</h4>
                        <img class="img-fluid" alt="" src="{{ url_for('static', filename='images/logo1.1.png') }}">
                        <div style="text-align: justify;"><p style="text-align: center;">TJTT = Tongji Table Tennis</p>Logo设计为球台，球台上的模糊红点为运动的乒乓球。黑色直线简约，棱角分明，具有科技感；红色乒乓球醒目，富有动感。选色来自球拍的正反面胶皮颜色。</div>
                    </div>
                </div>
            </div>

        </div>


        <div class="row">
            <div class="col-md-6 col-lg-6">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex align-items-start">
                            <h4 class="card-title mb-0">TJTT相册</h4>
                        </div><br/>
                        <div id="demo" class="carousel side" data-ride="carousel">
                            <!-- 指示符 -->
                            <ul class="carousel-indicators">
                                <li data-target="#demo" data-slide-to="0" class="active"></li>
                                {% for x in range(8) %}
                                    <li data-target="#demo" data-slide-to="{{ x+1 }}"></li>
                                {% endfor %}
                           </ul>
                            <!-- 轮播图片 -->
                            <div class="carousel-inner">
                                <div class="carousel-item active">
                                    <img class="img-fluid" alt="" src="{{ url_for('static', filename='images/album/1.jpg') }}">
                                </div>
                                <div class="carousel-item">
                                    <img class="img-fluid" alt="" src="{{ url_for('static', filename='images/album/2.jpg') }}">
                                </div>
                                <div class="carousel-item">
                                    <img class="img-fluid" alt="" src="{{ url_for('static', filename='images/album/3.jpg') }}">
                                </div>
                                <div class="carousel-item">
                                    <img class="img-fluid" alt="" src="{{ url_for('static', filename='images/album/4.jpg') }}">
                                </div>
                                <div class="carousel-item">
                                    <img class="img-fluid" alt="" src="{{ url_for('static', filename='images/album/5.jpg') }}">
                                </div>
                                <div class="carousel-item">
                                    <img class="img-fluid" alt="" src="{{ url_for('static', filename='images/album/6.jpg') }}">
                                </div>
                                <div class="carousel-item">
                                    <img class="img-fluid" alt="" src="{{ url_for('static', filename='images/album/7.jpg') }}">
                                </div>
                                <div class="carousel-item">
                                    <img class="img-fluid" alt="" src="{{ url_for('static', filename='images/album/8.jpg') }}">
                                </div>
                                <div class="carousel-item">
                                    <img class="img-fluid" alt="" src="{{ url_for('static', filename='images/album/9.jpg') }}">
                                </div>
                            </div>
                            <!-- 左右切换按钮 -->
                            <a href="#demo" class="carousel-control-prev" data-slide="prev">
                                <span class="carousel-control-prev-icon"></span>
                            </a>
                            <a href="#demo" class="carousel-control-next" data-slide="next">
                                <span class="carousel-control-next-icon"></span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-6">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title mb-4">平台使用教程</h4>
                        <video width="100%" height="100%" controls>
{#                            <source src="{{ url_for('static', filename='videos/instruction.ogg') }}" type="video/ogg">#}
                            <source src="{{ url_for('static', filename='videos/instruction.mp4') }}" type="video/mp4">
{#                            <source src="{{ url_for('static', filename='videos/instruction.webm') }}" type="video/webm">#}
                            <object data="{{ url_for('static', filename='videos/instruction.mp4') }}" width="320" height="240">
                                <embed width="100%" height="100%" src="{{ url_for('static', filename='videos/instruction.mp4') }}">
                            </object>
                        </video>
                        <p style="text-align: end;">Made by Charlie. BU</p>
                    </div>
                </div>
            </div>
        </div>


        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title mb-4">{{ _("乒乓球精彩训练、比赛视频及技战术教学") }}</h4>
                        <div class="table-responsive">
                            <table class="table no-wrap v-middle mb-0">
                                <tbody>
                                <tr style="text-align: center;">
                                    <td style="width: 600px; height: 450px;">
                                        <video width="100%" height="100%" controls>
                                            <source src="{{ url_for('static', filename='videos/1.mp4') }}" type="video/mp4">
                                            <object data="{{ url_for('static', filename='videos/1.mp4') }}" width="320" height="240">
                                                <embed width="100%" height="100%" src="{{ url_for('static', filename='videos/1.mp4') }}">
                                            </object>
                                        </video>
                                        <p class="text-right text-dark">等点慢搓 @北体战术学长🏓</p>
                                    </td>
                                    <td style="width: 600px; height: 450px;">
                                        <video width="100%" height="100%" controls>
                                            <source src="{{ url_for('static', filename='videos/2.mp4') }}" type="video/mp4">
                                            <object data="{{ url_for('static', filename='videos/2.mp4') }}" width="320" height="240">
                                                <embed width="100%" height="100%" src="{{ url_for('static', filename='videos/2.mp4') }}">
                                            </object>
                                        </video>
                                        <p class="text-right text-dark">防高调弧圈球 @尤琦乒乓</p>
                                    </td>
                                    <td style="width: 600px; height: 450px;">
                                        <video width="100%" height="100%" controls>
                                            <source src="{{ url_for('static', filename='videos/3.mp4') }}" type="video/mp4">
                                            <object data="{{ url_for('static', filename='videos/3.mp4') }}" width="320" height="240">
                                                <embed width="100%" height="100%" src="{{ url_for('static', filename='videos/3.mp4') }}">
                                            </object>
                                        </video>
                                        <p class="text-right text-dark">比赛：姚萌 vs 于何一</p>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-4">
                            <h4 class="card-title">{{ _("TJTT核心成员")}}</h4>
                        </div>
                        <div class="table-responsive">
                            <table class="table no-wrap v-middle mb-0">
                                <thead>
                                <tr class="border-0">
                                    <th class="border-0 font-14 font-weight-medium text-muted">{{_("成员")}}</th>
                                    <th class="border-0 font-14 font-weight-medium text-muted px-2">{{_("负责工作")}}</th>
                                    <th class="border-0 font-14 font-weight-medium text-muted text-center">{{_("所属组织")}}</th>
                                    <th class="border-0 font-14 font-weight-medium text-muted text-center">{{_("所在学校")}}</th>
                                    <th class="border-0 font-14 font-weight-medium text-muted text-center">{{ _("TJTT积分")}}</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td class="border-top-0 px-2 py-4">
                                        <div class="d-flex no-block align-items-center">
                                            <div class="mr-3"><img
                                                    src="{{ url_for('static', filename='images/admins/qgb.jpg') }}"
                                                    alt="user" class="rounded-circle" width="45"
                                                    height="45"/></div>
                                            <div class="">
                                                <h5 class="text-dark mb-0 font-16 font-weight-medium">{{ elite5.username }}</h5>
                                                <span class="text-muted font-14">{{ elite5.email }}</span>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="border-top-0 text-dark px-2 py-4 font-14">{{_("统筹规划")}}</td>
                                    <td class="border-top-0 px-2 py-4">
                                        <div class="popover-icon text-center">
                                            <a class="btn btn-primary rounded-circle btn-circle font-12 popover-item"
                                               href="javascript:void(0)">TJTT</a>
                                            <a class="btn btn-danger rounded-circle btn-circle font-12 popover-item"
                                               href="javascript:void(0)">校队</a>
                                            <a class="btn btn-cyan rounded-circle btn-circle font-12 popover-item"
                                               href="javascript:void(0)">乒协</a>
                                            {#                                                <a class="btn btn-success text-white rounded-circle btn-circle font-20"#}
                                            {#                                                    href="javascript:void(0)">+</a>#}
                                        </div>
                                    </td>
                                    <td class="text-dark text-center px-2 py-4">{{ elite5.school }}</td>
                                    <td class="border-top-0 text-center font-weight-medium text-dark px-2 py-4">{{ elite5.score }}</td>
                                </tr>
                                <tr>
                                    <td class="px-2 py-4">
                                        <div class="d-flex no-block align-items-center">
                                            <div class="mr-3"><img
                                                    src="{{ url_for('static', filename='images/admins/bt.jpg') }}"
                                                    alt="user" class="rounded-circle" width="45"
                                                    height="45"/></div>
                                            <div class="">
                                                <h5 class="text-dark mb-0 font-16 font-weight-medium">{{ elite1.username }}</h5>
                                                <span class="text-muted font-14">{{ elite1.email }}</span>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="text-dark px-2 py-4 font-14">{{_("平台开发")}}</td>
                                    <td class="px-2 py-4">
                                        <div class="popover-icon text-center">
                                            <a class="btn btn-primary rounded-circle btn-circle font-12 popover-item"
                                               href="javascript:void(0)">TJTT</a>
                                            <a class="btn btn-danger rounded-circle btn-circle font-12 popover-item"
                                               href="javascript:void(0)">校队</a>
                                            <a class="btn btn-cyan rounded-circle btn-circle font-12 popover-item"
                                               href="javascript:void(0)">乒协</a>
                                            {#                                                <a class="btn btn-success text-white rounded-circle btn-circle font-20"#}
                                            {#                                                    href="javascript:void(0)">+</a>#}
                                        </div>
                                    </td>
                                    <td class="text-dark text-center px-2 py-4">{{ elite1.school }}</td>
                                    <td class="text-center text-dark font-weight-medium px-2 py-4">{{ elite1.score }}</td>
                                </tr>
                                <tr>
                                    <td class="px-2 py-4">
                                        <div class="d-flex no-block align-items-center">
                                            <div class="mr-3"><img
                                                    src="{{ url_for('static', filename='images/admins/lpt.jpg') }}"
                                                    alt="user" class="rounded-circle" width="45"
                                                    height="45"/></div>
                                            <div class="">
                                                <h5 class="text-dark mb-0 font-16 font-weight-medium">{{ elite4.username }}</h5>
                                                <span class="text-muted font-14">{{ elite1.email }}</span>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="text-dark px-2 py-4 font-14">{{_("平台开发")}}</td>
                                    <td class="px-2 py-4">
                                        <div class="popover-icon text-center">
                                            <a class="btn btn-primary rounded-circle btn-circle font-12 popover-item"
                                               href="javascript:void(0)">TJTT</a>
                                            <a class="btn btn-danger rounded-circle btn-circle font-12 popover-item"
                                               href="javascript:void(0)">校队</a>
                                            <a class="btn btn-cyan rounded-circle btn-circle font-12 popover-item"
                                               href="javascript:void(0)">乒协</a>
                                            {#                                                <a class="btn btn-success text-white rounded-circle btn-circle font-20"#}
                                            {#                                                    href="javascript:void(0)">+</a>#}
                                        </div>
                                    </td>
                                    <td class="text-dark text-center px-2 py-4">{{ elite4.school }}</td>
                                    <td class="text-center text-dark font-weight-medium px-2 py-4">{{ elite4.score }}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block scripts %}
    <!--导入我们定义的Ajax请求函数，全局变量res-->
    <script src="{{ url_for('static', filename='js/ajax_request.js') }}"></script>
    <!--本页面用到的函数-->
    <script type="text/javascript">

        // 获取全局变量user, 即登录的用户身份，以判断是否为管理
        let isAdmin1;
        {% if user %}
            get_g("{{ user.usertype }}")
        {% endif %}
        function get_g(g_user_type) {
            isAdmin1 = g_user_type;
        }

        // 删除公告
        function delete_notice(id) {
            if (isAdmin1 != "K10" && isAdmin1 != "K11") {
                alert("{{_("权限不足")}}！");
                return;
            }
            if (confirm("{{_("确定删除该公告")}}？")) {
                fetch_ajax('POST', 'delete_notice', {'id': id, 'my_id': {{ user.id }}}, "user")
                setTimeout(function () {
                    alert(res.message);
                    location.reload();
                }, 500);
            }
        }

        // 表格分页
        var theUL = document.getElementById("pageListTableBody");
        var totalPage = document.getElementById("spanTotalPage");
        var pageNum = document.getElementById("spanPageNum"); //获取当前页<span>
        var spanPre = document.getElementById("spanPre"); //获取上一页<span>
        var spanNext = document.getElementById("spanNext"); //获取下一页<span>
        var spanFirst = document.getElementById("spanFirst"); //获取第一页<span>
        var spanLast = document.getElementById("spanLast"); //获取最后一页<span>
        var numberRowsInTable = theUL.getElementsByTagName("tr").length; //记录总条数
        var pageSize = 4; //每页显示的记录条数
        var page = 1; //当前页，默认第一页

        // 下一页
        function next() {
            hideTable();
            currentRow = pageSize * page;
            maxRow = currentRow + pageSize;
            if (maxRow > numberRowsInTable) maxRow = numberRowsInTable;
            for (var i = currentRow; i < maxRow; i++) {
                theUL.getElementsByTagName("tr")[i].style.display = '';
            }
            page++;
            if (maxRow == numberRowsInTable) {
                nextText();
                lastText();
            }
            showPage();
            preLink();
            firstLink();
        }

        // 上一页
        function pre() {
            hideTable();
            page--;
            currentRow = pageSize * page;
            maxRow = currentRow - pageSize;
            if (currentRow > numberRowsInTable) currentRow = numberRowsInTable;
            for (var i = maxRow; i < currentRow; i++) {
                theUL.getElementsByTagName("tr")[i].style.display = '';
            }
            if (maxRow == 0) {
                preText();
                firstText();
            }
            showPage();
            nextLink();
            lastLink();
        }

        // 首页
        function first() {
            hideTable();
            page = 1;
            for (var i = 0; i < pageSize; i++) {
                theUL.getElementsByTagName("tr")[i].style.display = '';
            }
            showPage();
            firstText();
            preText();
            nextLink();
            lastLink();
        }

        // 末页
        function last() {
            hideTable();
            page = pageCount();
            currentRow = pageSize * (page - 1);
            for (var i = currentRow; i < numberRowsInTable; i++) {
                theUL.getElementsByTagName("tr")[i].style.display = '';
            }
            showPage();
            preLink();
            nextText();
            firstLink();
            lastText();
        }

        function hideTable() {
            for (var i = 0; i < numberRowsInTable; i++) {
                theUL.getElementsByTagName("tr")[i].style.display = 'none';
            }
        }

        function showPage() {
            pageNum.innerHTML = page;
        }

        // 总页数
        function pageCount() {
            return Math.ceil(numberRowsInTable / pageSize);
        }

        // 显示链接
        function preLink() {
            spanPre.innerHTML = "<a href='javascript:pre();'>上一页</a>";
        }

        function preText() {
            spanPre.innerHTML = "上一页";
        }

        function nextLink() {
            spanNext.innerHTML = "<a href='javascript:next();'>下一页</a>";
        }

        function nextText() {
            spanNext.innerHTML = "下一页";
        }

        function firstLink() {
            spanFirst.innerHTML = "<a href='javascript:first();'>首页</a>";
        }

        function firstText() {
            spanFirst.innerHTML = "首页";
        }

        function lastLink() {
            spanLast.innerHTML = "<a href='javascript:last();'>末页</a>";
        }

        function lastText() {
            spanLast.innerHTML = "末页";
        }

        // 隐藏
        function hide() {
            for (var i = pageSize; i < numberRowsInTable; i++) {
                theUL.getElementsByTagName("tr")[i].style.display = 'none';
            }
            totalPage.innerHTML = pageCount();
            pageNum.innerHTML = '1';
            nextLink();
            lastLink();
        }
        hide();

        {#// 轮播图片遍历#}
        {# var carouselInner = document.getElementById("pic");#}
        {#  var s = "";#}
        {#for (int i=0; i<100; i++){#}
        {#    s = s + "<div class='carousel-item'><img class=\" img-fluid\" src=\"{{ url_for('static', filename='images/album/' + i + '.jpg') }}"#}
        {#carouselInner.innerHTML = s;#}

    </script>
{% endblock %}
